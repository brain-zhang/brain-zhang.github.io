
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>å´æ©è¾¾æœºå™¨å­¦ä¹ ç¬”è®°-2 - Living a Simple Life is a Happy Life</title>
  <meta name="author" content="brain-zhang">

  
  <meta name="description" content="Logisticå›å½’ï¼Œ æ­£åˆ™åŒ– 1-Logisticå›å½’ åˆ†ç±» é€»è¾‘å›å½’ (Logistic Regression)æ˜¯åˆ†ç±»é—®é¢˜çš„ä¸€ä¸ªä»£è¡¨ç®—æ³•ï¼Œè¿™æ˜¯ç›®å‰æœ€æµè¡Œä½¿ç”¨æœ€å¹¿æ³›çš„ä¸€ç§å­¦ä¹ ç®—æ³•ã€‚ æˆ‘ä»¬å°†å› å˜é‡(dependant variable)å¯èƒ½å±äºçš„ä¸¤ä¸ªç±»åˆ†åˆ«ç§°ä¸ºè´Ÿå‘ç±»ï¼ˆnegative classï¼‰ &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  

  
  <link rel="canonical" href="https://brain-zhang.github.io/blog/2019/09/11/wu-en-da-ji-qi-xue-xi-2">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Living a Simple Life is a Happy Life" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//libs.baidu.com/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<!-- 
<link href="//fonts.lug.ustc.edu.cn/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.lug.ustc.edu.cn/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
-->
<link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
<!-- mathjax config similar to math.stackexchange -->
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  jax: ["input/TeX", "output/HTML-CSS"],
  tex2jax: {
    inlineMath: [ ['$', '$'] ],
    displayMath: [ ["$$", "$$"]],
    processEscapes: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
  },
  messageStyle: "none",
  "HTML-CSS": { preferredFont: "TeX", availableFonts: ["STIX","TeX"] }
});
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>



  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Living a Simple Life is a Happy Life</a></h1>
  
    <h2>æœ‰é¥­åƒï¼Œè‡ªç”±è‡ªåœ¨ï¼Œå°±éå¸¸å¼€å¿ƒ</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="sitesearch" value="brain-zhang.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
<li><a href="/"><i class="fa fa-home"></i> ä¸»é¡µ</a></li>
  <li><a href="/blog/categories/blockchain/"><i class="fa fa-flask"></i>blockchain</a></li>
  <li><a href="/blog/categories/network/"><i class="fa fa-flask"></i>network</a></li>
  <li><a href="/blog/categories/develop/"><i class="fa fa-flask"></i>develop</a></li>
  <li><a href="/blog/categories/ai/"><i class="fa fa-flask"></i>AI</a></li>
  <li><a href="/blog/categories/tools/"><i class="fa fa-flask"></i>tools</a></li>
  <li><a href="/blog/categories/life/"><i class="fa fa-flask"></i>life</a></li>
  <li><a href="/blog/archives"><i class="fa fa-list-ul"></i>å­˜æ¡£</a></li>
  <li><a href="/about">å…³äº</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">å´æ©è¾¾æœºå™¨å­¦ä¹ ç¬”è®°-2</h1>
    
    
      <p class="meta">
        








  


<time datetime="2019-09-11T10:53:38+08:00" pubdate data-updated="true">Sep 11<span>th</span>, 2019</time>
        
           | <a href="#disqus_thread"
             data-disqus-identifier="https://brain-zhang.github.io">Comments</a>
        
      </p>
    
  </header>


<div class="entry-content"><p class="info">Logisticå›å½’ï¼Œ æ­£åˆ™åŒ–</p>

<!-- more -->

<h2 id="logistic">1-Logisticå›å½’</h2>

<h4 id="section">åˆ†ç±»</h4>

<p>é€»è¾‘å›å½’ (Logistic Regression)æ˜¯åˆ†ç±»é—®é¢˜çš„ä¸€ä¸ªä»£è¡¨ç®—æ³•ï¼Œè¿™æ˜¯ç›®å‰æœ€æµè¡Œä½¿ç”¨æœ€å¹¿æ³›çš„ä¸€ç§å­¦ä¹ ç®—æ³•ã€‚</p>

<p>æˆ‘ä»¬å°†å› å˜é‡(dependant variable)å¯èƒ½å±äºçš„ä¸¤ä¸ªç±»åˆ†åˆ«ç§°ä¸ºè´Ÿå‘ç±»ï¼ˆnegative classï¼‰å’Œ æ­£å‘ç±»ï¼ˆpositive classï¼‰ï¼Œåˆ™å› å˜é‡  ğ‘¦âˆˆ0,1 ï¼Œå…¶ä¸­ 0 è¡¨ç¤ºè´Ÿå‘ç±»ï¼Œ1 è¡¨ç¤ºæ­£å‘ç±»ã€‚</p>

<p>åˆ†ç±»é—®é¢˜ä¸‹ï¼Œå¯ä»¥é‡‡ç”¨é€»è¾‘å›å½’çš„åˆ†ç±»ç®—æ³•ï¼Œè¿™ä¸ªç®—æ³•çš„æ€§è´¨æ˜¯ï¼šå®ƒçš„è¾“å‡ºå€¼æ°¸è¿œåœ¨ 0 åˆ° 1 ä¹‹é—´ã€‚ å®ƒé€‚ç”¨äºæ ‡ç­¾ y å–å€¼ç¦»æ•£çš„æƒ…å†µï¼Œå¦‚ï¼š1 0 0 1ã€‚</p>

<h4 id="section-1">å‡è®¾é™ˆè¿°</h4>

<p>åˆ†ç±»é—®é¢˜ï¼Œå¸Œæœ›åˆ†ç±»å™¨çš„è¾“å‡ºå€¼åœ¨ 0 å’Œ 1 ä¹‹é—´ï¼Œå› æ­¤ï¼Œå‡è®¾å‡½æ•°éœ€è¦æ»¡è¶³é¢„æµ‹å€¼è¦åœ¨ 0 å’Œ 1 ä¹‹é—´ã€‚</p>

<p>å›å½’æ¨¡å‹çš„å‡è®¾æ˜¯ï¼š</p>

<script type="math/tex; mode=display">
h_\theta(x)=g(\theta^TX)
</script>

<p>å…¶ä¸­ï¼š</p>

<ul>
  <li>
    <p>X ä»£è¡¨ç‰¹å¾å‘é‡</p>
  </li>
  <li>
    <p>g ä»£è¡¨é€»è¾‘å‡½æ•°ï¼ˆlogistic functionï¼‰, æ˜¯ä¸€ä¸ªå¸¸ç”¨çš„é€»è¾‘å‡½æ•°ä¸º Så½¢å‡½æ•°ï¼ˆSigmoid functionï¼‰ï¼Œå…¬å¼ä¸ºï¼š</p>
  </li>
</ul>

<script type="math/tex; mode=display">
g(z) = \frac{1}{1+e^{-z}}
</script>

<ul>
  <li>python ä»£ç å®ç°sigmoidå‡½æ•°ï¼š</li>
</ul>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
</pre></td><td class="code"><pre><code class=""><span class="line">import numpy as np
</span><span class="line">def sigmoid(z):
</span><span class="line">    return 1 / (1 + np.exp(-z))</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>ç»“åˆèµ·æ¥ï¼Œè·å¾—é€»è¾‘å›å½’çš„å‡è®¾ï¼š</p>

<script type="math/tex; mode=display">
h_\theta(x) =  \frac{1}{1+e^{-\theta^TX}}
</script>

<table>
  <tbody>
    <tr>
      <td>ğœƒ(ğ‘¥) çš„ä½œç”¨æ˜¯ï¼Œå¯¹äºç»™å®šçš„è¾“å…¥å˜é‡ï¼Œæ ¹æ®é€‰æ‹©çš„å‚æ•°è®¡ç®—è¾“å‡ºå˜é‡ä¸º1 çš„å¯èƒ½æ€§ ï¼ˆestimated probablityï¼‰ï¼Œå³  â„ğœƒ(ğ‘¥)=ğ‘ƒ(ğ‘¦=1</td>
      <td>ğ‘¥;ğœƒ) ã€‚</td>
    </tr>
  </tbody>
</table>

<h4 id="section-2">ä»£ä»·å‡½æ•°</h4>

<p>é€»è¾‘å›å½’çš„ä»£ä»·å‡½æ•°ä¸ºï¼š</p>

<script type="math/tex; mode=display">
J(\theta)= \frac{1}{m}\sum^m_{i=1}Cost(h_\theta(x^{(i)}), y^{(i)})
</script>

<p>å…¶ä¸­:</p>

<script type="math/tex; mode=display">
Cost(h_\theta(x), y)=-y\times{log(h_\theta(x))}-(1-y)\times{log(1-h_\theta(x))}
</script>

<p>ä»£å…¥ä»£ä»·å‡½æ•°:</p>

<script type="math/tex; mode=display">
J(\theta) = -\frac{1}{m}\sum^m_{i=1}[y^{(i)}log(h_\theta(x^{(i)}))+(1-y^{(i)})log(1-h_\theta(x^{(i)}))]
</script>

<ul>
  <li>é€»è¾‘å›å½’ä»£ä»·å‡½æ•°çš„Pythonä»£ç å®ç°ï¼š</li>
</ul>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
</pre></td><td class="code"><pre><code class=""><span class="line">import numpy as np
</span><span class="line">def cost(theta, X, y):
</span><span class="line">    theta = np.matrix(theta)
</span><span class="line">    X = np.matrix(X)
</span><span class="line">    y = np.matrix(y)
</span><span class="line">    first = np.multiply(-y, np.log(sigmoid(X * theta.T)))
</span><span class="line">    second = np.multiply((1 - y), np.log(1 - sigmoid(X * theta.T)))
</span><span class="line">    return np.sum(first - second) / (len(X))</span></code></pre></td></tr></table></div></figure></notextile></div>

<h4 id="section-3">ç®€åŒ–ä»£ä»·å‡½æ•°å’Œæ¢¯åº¦ä¸‹é™</h4>

<script type="math/tex; mode=display">
\theta_j := \theta_j - \alpha \frac{1}{m}\sum^m_{i=1}(h_\theta(x^{(i)})-y^{(i)})x^{(i)}_j
</script>

<p>è¿™ä¸ªæ›´æ–°è§„åˆ™å’Œä¹‹å‰ç”¨æ¥åšçº¿æ€§å›å½’æ¢¯åº¦ä¸‹é™çš„å¼å­æ˜¯ä¸€æ ·çš„ï¼Œ ä½†æ˜¯å‡è®¾çš„å®šä¹‰å‘ç”Ÿäº†å˜åŒ–ã€‚å³ä½¿æ›´æ–°å‚æ•°çš„è§„åˆ™çœ‹èµ·æ¥åŸºæœ¬ç›¸åŒï¼Œä½†ç”±äºå‡è®¾çš„å®šä¹‰å‘ç”Ÿäº†å˜åŒ–ï¼Œæ‰€ä»¥é€»è¾‘å‡½æ•°çš„æ¢¯åº¦ä¸‹é™ï¼Œè·Ÿçº¿æ€§å›å½’çš„æ¢¯åº¦ä¸‹é™å®é™…ä¸Šæ˜¯ä¸¤ä¸ªå®Œå…¨ä¸åŒçš„ä¸œè¥¿ã€‚</p>

<h4 id="section-4">å¤šåˆ†ç±»ä»»åŠ¡ ä¸€å¯¹å¤š</h4>

<p>é‚®ä»¶å½’ç±»ï¼Œ å‡å¦‚è¯´ä½ ç°åœ¨éœ€è¦ä¸€ä¸ªå­¦ä¹ ç®—æ³•èƒ½è‡ªåŠ¨åœ°å°†é‚®ä»¶å½’ç±»åˆ°ä¸åŒçš„æ–‡ä»¶å¤¹é‡Œï¼ŒåŒºåˆ†å¼€æ¥è‡ªå·¥ä½œçš„é‚®ä»¶ã€æ¥è‡ªæœ‹å‹çš„é‚®ä»¶ã€æ¥è‡ªå®¶äººçš„é‚®ä»¶æˆ–è€…æ˜¯æœ‰å…³å…´è¶£çˆ±å¥½çš„é‚®ä»¶ï¼Œé‚£ä¹ˆï¼Œå°±æœ‰äº†ä¸€ä¸ªå››åˆ†ç±»é—®é¢˜ï¼šå…¶ç±»åˆ«æœ‰å››ä¸ªï¼Œåˆ†åˆ«ç”¨ y=1ã€y=2ã€y=3ã€y=4 æ¥ä»£è¡¨ã€‚</p>

<p>å¤šåˆ†ç±»çš„å…³é”®å°±æ˜¯æ„å»ºå¤šä¸ªé€»è¾‘åˆ†ç±»å‡½æ•°ï¼›å…·ä½“ï¼š</p>

<p>æˆ‘ä»¬å°†å¤šä¸ªç±»ä¸­çš„ä¸€ä¸ªç±»æ ‡è®°ä¸ºæ­£å‘ç±»ï¼ˆy=1ï¼‰ï¼Œç„¶åå°†å…¶ä»–æ‰€æœ‰ç±»éƒ½æ ‡è®°ä¸ºè´Ÿå‘ç±»ï¼Œè¿™ä¸ªæ¨¡å‹è®°ä½œ â„(1)ğœƒ(ğ‘¥)ã€‚æ¥ç€ï¼Œç±»ä¼¼åœ°ç¬¬æˆ‘ä»¬é€‰æ‹©å¦ä¸€ä¸ªç±»æ ‡è®°ä¸º æ­£å‘ç±»ï¼ˆy=2ï¼‰ï¼Œå†å°†å…¶å®ƒç±»éƒ½æ ‡è®°ä¸ºè´Ÿå‘ç±»ï¼Œå°†è¿™ä¸ªæ¨¡å‹è®°ä½œ  â„(2)ğœƒ(ğ‘¥) ,ä¾æ­¤ç±»æ¨ã€‚ æœ€åæˆ‘ä»¬å¾—åˆ°ä¸€ç³»åˆ—çš„æ¨¡å‹ç®€è®°ä¸ºï¼š</p>

<script type="math/tex; mode=display">
h^{(i)_\theta(x)} = p(y=i|x;\theta)
</script>

<p>æœ€åï¼Œåœ¨æˆ‘ä»¬éœ€è¦åšé¢„æµ‹æ—¶ï¼Œæˆ‘ä»¬å°†æ‰€æœ‰çš„åˆ†ç±»æœºéƒ½è¿è¡Œä¸€éï¼Œç„¶åå¯¹æ¯ä¸€ä¸ªè¾“å…¥å˜é‡ï¼Œéƒ½é€‰æ‹©æœ€é«˜å¯èƒ½æ€§çš„è¾“å‡ºå˜é‡ã€‚ æ€»ä¹‹ï¼Œæˆ‘ä»¬å·²ç»æŠŠè¦åšçš„åšå®Œäº†ï¼Œç°åœ¨è¦åšçš„å°±æ˜¯è®­ç»ƒè¿™ä¸ªé€»è¾‘å›å½’åˆ†ç±»å™¨ï¼š â„(ğ‘–)ğœƒ(ğ‘¥) ï¼Œ å…¶ä¸­ iå¯¹åº”æ¯ä¸€ä¸ªå¯èƒ½çš„y=iï¼Œæœ€åï¼Œä¸ºäº†åšå‡ºé¢„æµ‹ï¼Œæˆ‘ä»¬ç»™å‡ºè¾“å…¥ä¸€ä¸ªæ–°çš„ x å€¼åšé¢„æµ‹ã€‚æˆ‘ä»¬è¦åšçš„å°±æ˜¯åœ¨æˆ‘ä»¬ä¸‰ä¸ªåˆ†ç±»å™¨é‡Œé¢è¾“å…¥ xï¼Œç„¶åæˆ‘ä»¬é€‰æ‹©ä¸€ä¸ªè®©  â„(ğ‘–)ğœƒ(ğ‘¥) æœ€å¤§çš„ iï¼Œå³</p>

<script type="math/tex; mode=display">
\max_ih^{(i)_\theta(x)}
</script>

<h2 id="section-5">2-æ­£åˆ™åŒ–</h2>

<h4 id="section-6">è¿‡æ‹Ÿåˆé—®é¢˜</h4>

<p>å°±ä»¥å¤šé¡¹å¼ç†è§£ï¼Œx çš„æ¬¡æ•°è¶Šé«˜ï¼Œæ‹Ÿåˆçš„è¶Šå¥½ï¼Œä½†ç›¸åº”çš„é¢„æµ‹çš„èƒ½åŠ›å°±å¯èƒ½å˜å·®ã€‚</p>

<p>å¦‚ä½•è§£å†³ï¼Ÿ</p>

<ul>
  <li>
    <p>ä¸¢å¼ƒä¸€äº›ä¸èƒ½å¸®åŠ©æˆ‘ä»¬æ­£ç¡®é¢„æµ‹çš„ç‰¹å¾ã€‚å¯ä»¥æ˜¯æ‰‹å·¥é€‰æ‹©ä¿ç•™å“ªäº›ç‰¹å¾ï¼Œæˆ–è€…ä½¿ç”¨ä¸€äº›æ¨¡å‹é€‰æ‹©çš„ç®—æ³•æ¥å¸®å¿™ï¼ˆä¾‹å¦‚ PCA, LDAï¼‰ï¼Œç¼ºç‚¹æ˜¯ä¸¢å¼ƒç‰¹å¾çš„åŒæ—¶ï¼Œä¹Ÿä¸¢å¼ƒäº†è¿™äº›ç›¸åº”çš„ä¿¡æ¯ï¼›</p>
  </li>
  <li>
    <p>æ­£åˆ™åŒ–ã€‚ ä¿ç•™æ‰€æœ‰çš„ç‰¹å¾ï¼Œä½†æ˜¯å‡å°‘å‚æ•°çš„å¤§å°ï¼ˆmagnitudeï¼‰ï¼Œå½“æˆ‘ä»¬æœ‰å¤§é‡çš„ç‰¹å¾ï¼Œæ¯ä¸ªç‰¹å¾éƒ½å¯¹ç›®æ ‡å€¼æœ‰ä¸€ç‚¹è´¡çŒ®çš„æ—¶å€™ï¼Œæ¯”è¾ƒæœ‰æ•ˆã€‚</p>
  </li>
  <li>
    <p>è¿˜æœ‰ä¸€ä¸ªè§£å†³æ–¹å¼å°±æ˜¯å¢åŠ æ•°æ®é›†,å› ä¸ºè¿‡æ‹Ÿåˆå¯¼è‡´çš„åŸå› å°±è¿‡åº¦æ‹Ÿåˆæµ‹è¯•æ•°æ®é›†, é‚£ä¹ˆå¢åŠ æ•°æ®é›†å°±å¾ˆå¤§ç¨‹åº¦æé«˜äº†æ³›åŒ–æ€§äº†.</p>
  </li>
</ul>

<h4 id="section-7">ä»£ä»·å‡½æ•°</h4>

<p>æ­£åˆ™åŒ–çš„åŸºæœ¬æ–¹æ³•ï¼šå¯¹é«˜æ¬¡é¡¹æ·»åŠ æƒ©ç½šå€¼ï¼Œè®©é«˜æ¬¡é¡¹çš„ç³»æ•°æ¥è¿‘äº0ã€‚</p>

<p>å‡å¦‚æˆ‘ä»¬æœ‰éå¸¸å¤šçš„ç‰¹å¾ï¼Œæˆ‘ä»¬å¹¶ä¸çŸ¥é“å…¶ä¸­å“ªäº›ç‰¹å¾æˆ‘ä»¬è¦æƒ©ç½šï¼Œæˆ‘ä»¬å°†å¯¹æ‰€æœ‰çš„ç‰¹å¾è¿›è¡Œæƒ©ç½šï¼Œå¹¶ä¸”è®©ä»£ä»·å‡½æ•°æœ€ä¼˜åŒ–çš„è½¯ä»¶æ¥é€‰æ‹©è¿™äº›æƒ©ç½šçš„ç¨‹åº¦ã€‚è¿™æ ·çš„ç»“æœæ˜¯å¾—åˆ°äº†ä¸€ä¸ªè¾ƒä¸ºç®€å•çš„èƒ½é˜²æ­¢è¿‡æ‹Ÿåˆé—®é¢˜çš„å‡è®¾ï¼š</p>

<script type="math/tex; mode=display">
J(\theta) = \frac{1}{2m} [ \sum_{i=1}^m(h_{\theta}(x^{(i)})-y^{(i)})^{2} + \lambda\sum_{j=1}^n\theta^2_j  ]
</script>

<p>å…¶ä¸­ ğœ† åˆç§°ä¸ºæ­£åˆ™åŒ–å‚æ•°ï¼ˆRegularization Parameterï¼‰</p>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
</pre></td><td class="code"><pre><code class=""><span class="line">import numpy as np
</span><span class="line">def mseWithRegular(predict, y, w, lmd=0.1):
</span><span class="line">    '''
</span><span class="line">        predict: æ¨¡å‹è¾“å‡º
</span><span class="line">        y: çœŸå®æ ‡ç­¾
</span><span class="line">        w: æ¨¡å‹æƒé‡
</span><span class="line">        lmd: æ­£åˆ™åŒ–å‚æ•°
</span><span class="line">    '''
</span><span class="line">    constrct_loss = np.sum((predict - y) ** 2)
</span><span class="line">    experience_loss = lmd * np.sum(w ** 2)
</span><span class="line">    loss = (constrct_loss + experience_loss) / (2 * len(predict))
</span><span class="line">    return loss
</span><span class="line">
</span><span class="line">predict = np.array([1, 1.5, 2])
</span><span class="line">y = np.array([0.9, 1.4, 2.1])
</span><span class="line">w = np.array([[1], [1], [1]])
</span><span class="line">mseWithRegular(predict, y, w)</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>å¦‚æœé€‰æ‹©çš„æ­£åˆ™åŒ–å‚æ•° ğœ† è¿‡å¤§ï¼Œåˆ™ä¼šæŠŠæ‰€æœ‰çš„å‚æ•°éƒ½æœ€å°åŒ–äº†ï¼Œå¯¼è‡´æ¨¡å‹å˜æˆ  â„ğœƒ(ğ‘¥)=ğœƒ0 ï¼Œé€ æˆæ¬ æ‹Ÿåˆã€‚</p>

<p>æ‰€ä»¥å¯¹äºæ­£åˆ™åŒ–ï¼Œæˆ‘ä»¬è¦å–ä¸€ä¸ªåˆç†çš„Î»çš„å€¼ï¼Œè¿™æ ·æ‰èƒ½æ›´å¥½çš„åº”ç”¨æ­£åˆ™åŒ–ã€‚</p>

<h4 id="section-8">çº¿æ€§å›å½’æ­£åˆ™åŒ–</h4>
<p>å¯¹äºçº¿æ€§å›å½’çš„æ±‚è§£ï¼Œæˆ‘ä»¬ä¹‹å‰æ¨å¯¼äº†ä¸¤ç§å­¦ä¹ ç®—æ³•ï¼šä¸€ç§åŸºäºæ¢¯åº¦ä¸‹é™ï¼Œä¸€ç§åŸºäºæ­£è§„æ–¹ç¨‹</p>

<p>æ­£åˆ™åŒ–çº¿æ€§å›å½’çš„ä»£ä»·å‡½æ•°ä¸ºï¼š</p>

<script type="math/tex; mode=display">
J(\theta) = \frac{1}{2m} [ \sum_{i=1}^m(h_{\theta}(x^{(i)})-y^{(i)})^{2} + \lambda\sum_{j=1}^n\theta^2_j ]
</script>

<ul>
  <li>æ¢¯åº¦ä¸‹é™ä½¿ä»£ä»·å‡½æ•°æœ€å°åŒ–</li>
</ul>

<script type="math/tex; mode=display">
\theta_j := \theta_j (1-a\frac{\lambda}{m})- \alpha \frac{1}{m}\sum^m_{i=1}(h_\theta(x^{(i)})-y^{(i)})x^{(i)}_j
</script>

<ul>
  <li>æ­£è§„æ–¹ç¨‹æ¥æ±‚è§£æ­£åˆ™åŒ–çº¿æ€§å›å½’æ¨¡å‹</li>
</ul>

<p>TODO: æš‚æ—¶æ²¡æœ‰ç†è§£</p>

<h4 id="section-9">é€»è¾‘å›å½’æ­£åˆ™åŒ–</h4>

<p>é’ˆå¯¹é€»è¾‘å›å½’é—®é¢˜ï¼Œæˆ‘ä»¬åœ¨ä¹‹å‰çš„è¯¾ç¨‹å·²ç»å­¦ä¹ è¿‡ä¸¤ç§ä¼˜åŒ–ç®—æ³•ï¼šæ¢¯åº¦ä¸‹é™æ³•ï¼Œæ›´é«˜çº§çš„ä¼˜åŒ–ç®—æ³•éœ€è¦ä½ è‡ªå·±è®¾è®¡ä»£ä»·å‡½æ•° ğ½(ğœƒ) ã€‚</p>

<p>ç»™ä»£ä»·å‡½æ•°å¢åŠ ä¸€ä¸ªæ­£åˆ™åŒ–çš„è¡¨è¾¾å¼ï¼Œå¾—åˆ°ä»£ä»·å‡½æ•°:</p>

<script type="math/tex; mode=display">
J(\theta) = \frac{1}{m}\sum^m_{i=1}[-y^{(i)}log(h_\theta(x^{(i)}))-(1-y^{(i)}log(1-h_\theta(x^{(i)}))]+\frac{\lambda}{2m}\sum_{j=1}^n\theta^2_j
</script>

<p>ä»£ç å®ç°:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
</pre></td><td class="code"><pre><code class=""><span class="line">import numpy as np
</span><span class="line">def sigmoid(x, derivative=False):
</span><span class="line">    sigm = 1. / (1. + np.exp(-x))
</span><span class="line">    if derivative:
</span><span class="line">        return sigm * (1. - sigm)
</span><span class="line">    return sigm
</span><span class="line">
</span><span class="line">def costReg(theta, X, y, learningRate):
</span><span class="line">    theta = np.matrix(theta)
</span><span class="line">    X = np.matrix(X)
</span><span class="line">    y = np.matrix(y)
</span><span class="line">    first = np.multiply(-y, np.log(sigmoid(X * theta.T)))
</span><span class="line">    second = np.multiply((1 - y), np.log(1 - sigmoid(X * theta.T)))
</span><span class="line">    reg = (learningRate / 2 * len(X)) * np.sum(np.power(theta[:,1:theta.shape[1]], 2))
</span><span class="line">    return np.sum(first - second) / (len(X)) + reg</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>æœ€åï¼Œå®ƒçš„æ¢¯åº¦ä¸‹é™çœ‹ä¸Šå»åŒæ­£åˆ™åŒ–çš„çº¿æ€§å›å½’ä¸€æ ·ï¼Œä½†æ˜¯ç”±äºå‡è®¾â„ğœƒ(ğ‘¥)=ğ‘”(ğœƒğ‘‡ğ‘‹) ï¼Œæ‰€ä»¥ä¸çº¿æ€§å›å½’ä¸åŒã€‚</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">brain-zhang</span></span>

      








  


<time datetime="2019-09-11T10:53:38+08:00" pubdate data-updated="true">Sep 11<span>th</span>, 2019</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/ai/'>ai</a>, <a class='category' href='/blog/categories/develop/'>develop</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2019/09/06/unicode-string-parse-with-python-and-fileinput/" title="Previous Post: Unicode string parse with python and fileinput">&laquo; Unicode string parse with python and fileinput</a>
      
      
        <a class="basic-alignment right" href="/blog/2019/09/13/eltoo-shan-dian-he-chi-xian-qi-yue-geng-xin-ji-zhi/" title="Next Post: Eltoo-é—ªç”µå’Œç¦»çº¿å¥‘çº¦æ›´æ–°æœºåˆ¶">Eltoo-é—ªç”µå’Œç¦»çº¿å¥‘çº¦æ›´æ–°æœºåˆ¶ &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>æœ€æ–°å‘å¸ƒ</h1>
  <ul id="æœ€æ–°æ–‡ç« ">
    
      <li class="post">
        <a href="/blog/2024/12/13/yong-watchming-ling-gao-liang-shu-chu-de-bu-tong/">ç”¨watchå‘½ä»¤é«˜äº®è¾“å‡ºçš„ä¸åŒ</a>
      </li>
    
      <li class="post">
        <a href="/blog/2024/12/05/tui-jian-hen-hao-kan-de-wu-xia-xiao-shu-tian-zhi-xia/">æ¨èä¸€æœ¬å¾ˆå¥½çœ‹çš„æ­¦ä¾ å°è¯´--å¤©ä¹‹ä¸‹</a>
      </li>
    
      <li class="post">
        <a href="/blog/2024/10/14/aiwei-lai-shi-dai-hui-wei-wo-men-dai-lai-shi-yao/">AIæœªæ¥æ—¶ä»£ä¼šä¸ºæˆ‘ä»¬å¸¦æ¥ä»€ä¹ˆ</a>
      </li>
    
      <li class="post">
        <a href="/blog/2024/04/19/how-to-resize-partition-on-linux/">How to Resize Partition on Linux</a>
      </li>
    
      <li class="post">
        <a href="/blog/2024/04/03/how-to-solve-pci-passthrough-failed-got-timeout-with-pve-vm-starts-failed/">How to Solve 'PCI Passthrough Failed: Got Timeout' With PVE Vm Starts Failed</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/brain-zhang">@brain-zhang</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'brain-zhang',
            count: 10,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>





  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2024 - brain-zhang -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'memoryboxes';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'https://brain-zhang.github.io/blog/2019/09/11/wu-en-da-ji-qi-xue-xi-2/';
        var disqus_url = 'https://brain-zhang.github.io/blog/2019/09/11/wu-en-da-ji-qi-xue-xi-2/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>











</body>
</html>
